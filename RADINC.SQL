SET PAGESIZE  50000
SET LINESIZE  32767
SET LONG 327670 
SET LONGCHUNKSIZE 327670 
SET TRIMOUT ON 
SET TRIMSPOOL ON
SET FEEDBACK OFF;
SET HEADING OFF;
SET VERIFY OFF;
SET ESCAPE '\'
column SPOOLINC new_val SPOOLINC
column DYNSPOOLINC new_val DYNSPOOLINC
SELECT  '&2'||'/INC/' SPOOLINC FROM DUAL;
SELECT  '&2'||'/INC/DYNSPOOLINC.SQL' DYNSPOOLINC FROM DUAL;
SPOOL &DYNSPOOLINC;
PROMPT SET HEAD ON
PROMPT SET embedded ON
PROMPT SET COLSEP ,     
PROMPT SET PAGESIZE 50000   
PROMPT SET TRIMSPOOL ON 
PROMPT SET HEADSEP OFF
PROMPT SET ECHO OFF
PROMPT SET LONG 32767
PROMPT SET LONGCHUNKSIZE 32767
PROMPT SET LINESIZE 32767  
PROMPT SET NUMFORMAT 9999999999999999.99
PROMPT SET FEEDBACK OFF
PROMPT SET VERIFY OFF
SELECT SPOOL_START || CHR(10) || SPOOL_BODY || CHR(10) || SPOOL_END
FROM (SELECT 'SPOOL ' || '&SPOOLINC' || TABLE_NAME || '.CSV;' SPOOL_START,
       'SELECT ' || LISTAGG(COLUMN_NAME, ' , ') WITHIN GROUP(ORDER BY COLUMN_ID) || ' FROM ' || TABLE_NAME || ' WHERE FUNCTION_ID =' || '''&1'''||';' SPOOL_BODY,
       'SPOOL OFF;' SPOOL_END
FROM USER_TAB_COLUMNS
WHERE TABLE_NAME IN ('CSTB_FID_DATA_SOURCES',
                     'CSTB_FID_SCR_TABS',
                     'CSTB_FID_SCREENS',
                     'CSTB_SUMMARY_INFO',
                     'CSTB_FIELD_LABELS',
                     'SMTB_FUNCTION_DESCRIPTION',
                     'SMTB_MENU')
GROUP BY TABLE_NAME);
PROMPT SET VERIFY ON
PROMPT SET ECHO ON
PROMPT SET FEEDBACK ON
PROMPT EXIT
SPOOL OFF;
@&DYNSPOOLINC;
EXIT;